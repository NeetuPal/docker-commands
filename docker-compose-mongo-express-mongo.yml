version: '3.8' # Specify the Docker Compose file format version

services:
  # MongoDB Service
  mongodb:
    image: mongo:latest # Use the official MongoDB image
    container_name: mongodb # Optional: Assign a custom container name
    ports:
      - "27017:27017" # Map host port 27017 to container port 27017
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin # Set root username
      MONGO_INITDB_ROOT_PASSWORD: pass123 # Set root password (change for production)
    volumes:
      - mongo_data:/data/db # Persist MongoDB data to a named volume
    networks:
      - mongo-network   
    restart: always # Restart policy: always restart unless explicitly stopped

  # Mongo Express Service
  mongo-express:
    image: mongo-express:latest # Use the official Mongo Express image
    container_name: mongo-express # Optional: Assign a custom container name
    ports:
      - "8081:8081" # Map host port 8081 to container port 8081 (Mongo Express default)
    environment:
      ME_CONFIG_MONGODB_ADMINUSERNAME: admin
      ME_CONFIG_MONGODB_ADMINPASSWORD: pass123
      ME_CONFIG_MONGODB_SERVER: mongodb # Connect to the MongoDB service by its name
      ME_CONFIG_BASICAUTH_USERNAME: user # Set Mongo Express username
      ME_CONFIG_BASICAUTH_PASSWORD: pass # Set Mongo Express password (change for production)
    depends_on:
      - mongodb # Ensure MongoDB starts before Mongo Express
    networks:
      - mongo-network 
    restart: always

volumes:
  mongo_data: null # Define the named volume for MongoDB data persistence
networks:
  mongo-network: 
   driver: bridge
